# Жизненый цикл бина в спринг для разных скоупов в виде таблицы

Ниже представлена таблица с описанием жизненного цикла бина в Spring для разных скоупов (scopes).

| Скоуп | Создание экземпляра | Время жизни | Уничтожение | Примеры использования |
|-------|-------------------|-------------|-------------|---------------------|
| **Singleton** (по умолчанию) | Один экземпляр создаётся при старте контейнера (или при первом запросе) | Весь жизненный цикл ApplicationContext | При завершении работы контейнера | Сервисы без состояния (логирование, работа с БД, отправка email) |
| **Prototype** | Новый экземпляр при каждом запросе бина | До момента, когда ссылка на объект больше не используется (управление сборщиком мусора) | После того, как на объект не остаётся ссылок (GC) | Задачи, требующие изолированных данных (генерация отчётов, тестирование, формы с пользовательскими данными) |
| **Request** | Новый экземпляр для каждого HTTP‑запроса | В течение одного HTTP‑запроса | После завершения HTTP‑запроса | Временные данные запроса (корзина покупок, данные аутентификации, временные токены) |
| **Session** | Один экземпляр на HTTP‑сессию пользователя | В течение всей HTTP‑сессии пользователя | При завершении сессии (logout/timeout) | Данные, привязанные к пользователю (настройки профиля, история действий в сессии) |
| **Application** | Один экземпляр на весь контекст веб‑приложения | Весь жизненный цикл веб‑приложения | При завершении работы контейнера/сервлета | Глобальные настройки приложения, кэш, общие для всех пользователей данные |


### Пояснения к этапам жизненного цикла (общие для всех скоупов)

1. **Инициализация контейнера** — запуск Spring IoC‑контейнера.
2. **Создание экземпляра** (`Bean Instantiated`) — контейнер создаёт объект бина.
3. **Внедрение зависимостей** (`Dependencies Injected`) — Spring подставляет зависимости (через конструктор, сеттеры или поля).
4. **Инициализация** (`Custom init()`):
    - вызов метода `afterPropertiesSet()` (если бин реализует `InitializingBean`);
    - выполнение метода с аннотацией `@PostConstruct`;
    - вызов метода, указанного в `init-method`.
5. **Готов к использованию** (`Bean is Ready`) — бин полностью инициализирован и доступен для работы.
6. **Уничтожение** (`Custom destroy()`):
    - вызов метода `destroy()` (если бин реализует `DisposableBean`);
    - выполнение метода с аннотацией `@PreDestroy`;
    - вызов метода, указанного в `destroy-method` (при завершении работы контейнера).

### Важные замечания

- **Prototype + Singleton**: если prototype‑бин внедряется в singleton‑бин, Spring создаст только один экземпляр prototype. Для динамического получения новых экземпляров используйте `ObjectFactory` или `@Lookup`.
- **Веб‑скоупы** (`request`, `session`, `application`) доступны только в веб‑контексте (например, Spring MVC). В не‑веб‑приложениях возникнет ошибка `No Scope Registered for ScopeName`.
- **Память и производительность**: скоуп `prototype` может увеличивать нагрузку на память, так как создаёт новые экземпляры при каждом запросе.